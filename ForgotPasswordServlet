package com.yourpackage;

import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.*;
import java.io.*;
import com.google.gson.Gson;

@WebServlet("/auth/forgot-password")
public class ForgotPasswordServlet extends HttpServlet {
    private PasswordService passwordService = new PasswordService();

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws IOException {
        Gson gson = new Gson();
        BufferedReader reader = req.getReader();
        ForgotPasswordRequest request = gson.fromJson(reader, ForgotPasswordRequest.class);

        try {
            passwordService.forgotPassword(request.getUsername());
            resp.setStatus(200);
            resp.getWriter().write("Password reset link sent to email");
        } catch (RuntimeException e) {
            resp.setStatus(400);
            resp.getWriter().write(e.getMessage());
        }
    }
}

class ForgotPasswordRequest {
    private String username;
    public String getUsername() { return username; }
    public void setUsername(String username) { this.username = username; }
}
